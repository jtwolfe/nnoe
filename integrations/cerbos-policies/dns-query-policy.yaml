apiVersion: api.cerbos.dev/v1

resourcePolicy:
  version: default
  resource: dns_query
  rules:
    - actions: ['allow']
      effect: EFFECT_ALLOW
      roles: ['iot']
      condition:
        match:
          expr: request.time.hour < 18
    - actions: ['allow']
      effect: EFFECT_ALLOW
      roles: ['admin']
      condition:
        match:
          expr: true
    - actions: ['allow']
      effect: EFFECT_ALLOW
      roles: ['user']
      condition:
        match:
          expr: |
            !request.domain.contains("malicious") &&
            !request.domain.contains("blocked")

